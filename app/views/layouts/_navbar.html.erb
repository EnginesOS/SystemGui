<% active_menu_item = case
    when params[:controller] == 'desktops'
      :desktop
    else
      :control_panel
    end
%>

<% if user_signed_in? %>
	<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
	  <div class="container-fluid">
	    <div class="navbar-header">
	      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar-collapse">
	        <span class="sr-only">Toggle navigation</span>
	        <span class="icon-bar"></span>
	        <span class="icon-bar"></span>
	        <span class="icon-bar"></span>
	      </button>
	      <%= link_to image_tag("engines_logo.png", class: "navbar-icon"), root_path, class: 'trigger-response-modal navbar-brand' %>
	    </div>
	
	    <!-- Collect the nav links, forms, and other content for toggling -->
	    <div class="collapse navbar-collapse" id="main-navbar-collapse">
	      <ul class="nav navbar-nav">
	        <li class="<%= 'active' if active_menu_item == :desktop %>">
	          <%= link_to content_tag(:i, "", class: "fa fa-desktop") + " Desktop", desktop_path, title: 'Desktop', class: 'trigger-response-modal' %>
	        </li>
	        <li class="<%= 'active' if active_menu_item == :control_panel %>">
	          <%= link_to content_tag(:i, "", class: "fa fa-cogs") + " Control panel", control_panel_path, class: 'trigger-response-modal' %>
	        </li>
	      </ul>
	      <ul class="nav navbar-nav navbar-right">
	        <li class="dropdown">
	          <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= content_tag(:i, "", class: "fa fa-user") %> <%= current_user.email %><span class="caret"></span></a>
	          <ul class="dropdown-menu" role="menu">
	    		<li>
				  <% link_body = (content_tag(:i, '', class: 'fa fa-cog') + ' Manage admin'.html_safe) %>
				  <%= link_to link_body, user_path, class: 'trigger-response-modal' %>
		        </li>
	            <li class="divider"></li>
				<li>
					<%= link_to (content_tag(:i, "", class: "fa fa-sign-out") + " Sign out"),
						destroy_user_session_path,
						class: 'trigger-response-modal', :method => :delete %>
				</li>
	          </ul>
	        </li>
	      </ul>
	    </div>
	  </div>
	</nav>
	
<% else %>

<nav class="navbar user_signed_out navbar-default navbar-fixed-top" role="navigation">
	<div class="container-fluid">
		<%= link_to image_tag("engines_logo.png", class: "navbar-icon"), root_path, class: 'trigger-response-modal navbar-brand' %>

		<div class="pull-right">
			<ul class="nav pull-left">

		        <li class="dropdown desktop-signin">
		          <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" style="color: <%= @desktop_settings.icon_text_color %>;">
		          		<%= (content_tag(:i, "", class: "fa fa-sign-out") + " Sign in") %>
		          </a>
		          <ul class="dropdown-menu dropdown-menu-right" role="menu">
		    		<li>
							<%= form_for(:user, :url => new_user_session_path) do |f| %>
								<div class="form-group">
									<label for="user_username">Username</label>
									<%= f.text_field :username, class: 'form-control' %>
								</div>
								<div class="form-group">
									<label for="user_username">Password</label>
									<%= f.password_field :password, class: 'form-control' %>
								</div>
								<div class="form-group">
									<%= f.check_box(:remember_me) + ' ' + f.label(:remember_me, 'Remember me', class: 'form-text-lg') %>
								</div>
								<div class="form-group">
								  	<%= f.submit 'Sign in', class: 'btn btn-lg btn-primary' %>
								  	<%= link_to "Forgot your password?", new_user_password_path(), class: "btn btn-sm btn-default pull-right top-gap" %>
								</div>
							<% end %>
					</li>
		          </ul>
		        </li>

			</ul>
		</div>
	</div>
</nav>


<% end %>

