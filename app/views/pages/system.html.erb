<span class='system'>

  <div class="col-sm-12 well">
    <h3><%= content_tag(:i, "", class: "fa fa-tachometer") %> System</h3>

    <div class='top-gap'>
      <br>
      <% cpu_cnt = @system_info[:old][:cpu].length %>
      <%= cpu_cnt %> Cpus<br />
      <table>
        <th>CPU</th>
        <th>idle</th>
        <th>nice</th>
        <th>system</th>
        <th>user</th>
      <% @system_info[:old][:cpu].each do  |cpu|%>
        <tr>
            <% total = cpu.nice + cpu.idle + cpu.system + cpu.user 
            idle = cpu.idle.to_f / total.to_f * 100.0
            nice = cpu.nice.to_f  / total.to_f * 100.0
            system = cpu.system.to_f  / total.to_f * 100.0
            user = cpu.user.to_f  / total.to_f * 100.0 %>
            <td><%=cpu.num%> </td>
            <td><%=idle.to_i%> %</td>
            <td><%=nice.to_i%>%</td>
            <td><%=system.to_i%>%</td>
            <td><%=user.to_i%>%</td>                                
            </tr>

      <% end%>

      </table>

      <% 
      one = @system_info[:old][:snapshot].load_average.one_minute
      five =  @system_info[:old][:snapshot].load_average.five_minutes
      fithteen =  @system_info[:old][:snapshot].load_average.fifteen_minutes
      %><p>
      <strong>Load Averages</strong><br/>
      1 Minute:<b><%= one %></b><br>
      5 Minute:<b><%= five %></b><br /> 
      15 Minute:<b><%= fithteen%></b><br> 
      </p>
      <p>
         <strong>Memory</strong><br>
         <% ps = @system_info[:old][:snapshot].memory.pagesize
             ps = ps/1024
             active =  @system_info[:old][:snapshot].memory.active * ps
             free =   @system_info[:old][:snapshot].memory.free * ps
             inactive =  @system_info[:old][:snapshot].memory.inactive * ps
             wired =  @system_info[:old][:snapshot].memory.wired * ps
         %>
         <table>
             <th>Swap size</th>
             <th>Free</th>
             <th>active</th>
             <th>inactive</th>
             <th>wired</th>
             <th>Pageins</th>
             <th>PageOuts</th>
             <tr>
                 <td>belum</td>
                 <td><%=free%></td>
                 <td><%=active%></td>
                 <td><%=inactive%></td>
                 <td><%=wired%></td>
                 <% rateout =@system_info[:old][:vm2].pageouts - @system_info[:old][:snapshot].memory.pageouts %>
                 <% ratein = @system_info[:old][:vm2].pageins - @system_info[:old][:snapshot].memory.pageins %>
                 <td><%=rateout%> </td>
                 <td><%=ratein %> </td>
             </tr>
         </table>
      </p>

    </div>
  </div>

  <%= (ap @system_info, {html: true, plain: true}).html_safe %>

</span>
