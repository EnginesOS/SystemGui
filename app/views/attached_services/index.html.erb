<div class="col-sm-12">

  <h2 class=''><i class='fa fa-share-alt'></i> Attach services for <%= @software.engine_name %></h2>
  <%= link_to content_tag(:i, "", class: "fa fa-arrow-left") + ' Back', control_panel_path, class: "btn btn-warning btn-lg trigger-response-modal" %>

  <h3>Attached services</h3>
  <div>
    <% @software.attached_services_handler.attached_services.each do |attached_service| %>
      <div class="well well-sm">
        <h4><%= attached_service.title %></h4>
        <% available_subservices = EnginesSoftware.available_subservices(@software.engine_name, attached_service.service_type) %>
        <% if available_subservices.present? %>
          <% (ap EnginesSoftware.available_services_hash(@software.engine_name), plain: true, index: false).html_safe %>
        <% else %>
          There are no sub-service available to be added to this service.
        <% end %>
      </div>
    <% end %>
  </div>

  <% @software.attached_services_handler.available_services.each do |available_service| %>
    <div class="btn-group"><%= link_to content_tag(:i, "", class: "fa fa-plus") + ' Attach ' + available_service[:title], new_attached_service_path(software_id: @software, service_type: available_service[:service_type], service_provider: available_service[:service_provider]), class: "btn btn-default btn-lg trigger-response-modal" %></div><br>
      engine_name: <%= @software.engine_name %><br>
      service_type: <%= available_service[:service_type] %><br>
      service_provider: <%= available_service[:service_provider] %><br><br>
  <% end %>
 

<h3>Attached services</h3>
<%= (ap EnginesSoftware.attached_services(@software.engine_name), plain: true, index: false).html_safe %>
<h3>Available services</h3>
<%= (ap @software.attached_services_handler.available_services, plain: true, index: false).html_safe %>




</div>
