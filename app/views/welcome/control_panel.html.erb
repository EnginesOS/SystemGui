<div class="col-sm-6">
  <h2 class="control-panel-title"><%= content_tag(:i, "", class: "fa fa-cogs") %> Control panel</h2>
</div>

<div class="col-sm-6">
  <div class="btn-toolbar" role="toolbar">
    <div class="btn-group btn-group-lg pull-right">
      <%= link_to content_tag(:i, "", class: "fa fa-plus") + " Install", galleries_path, class: "btn btn-default" %>
      <%= link_to content_tag(:i, "", class: "fa fa-dashboard"), "", class: "btn btn-default", data: {toggle: "modal", target: "#modal_system_details"} %>
    </div>
  </div>
</div>

<div class="col-sm-12">
  <h3 class="control-panel-heading"><%= content_tag(:i, "", class: "fa fa-tablet") %> Application servers</h3>
  <% if @applications %>
      <% @applications.each do |application| %>
          <% @engine = application %>
          <%= render partial: "engines" %>
      <% end %>
  <% else %>
      <p>No application servers installed</p>
  <% end %>

  <h3 class="control-panel-heading"><%= content_tag(:i, "", class: "fa fa-hdd-o") %> Services</h3>
  <% @services.each do |service| %>
      <% @service = service %>
      <%= render partial: "service" %>
  <% end %>
</div>

<!-- Modal -->
<div class="modal fade" id="modal_system_details" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel"><%= content_tag(:i, "", class: "fa fa-dashboard") %> System details</h4>
      </div>
      <div class="modal-body">
        <% cpu_cnt = Vmstat.cpu.length %>
        <%= cpu_cnt %> Cpus<br />
        <table>
            <th>CPU</th>
            <th>idle</th>
            <th>nice</th>
            <th>system</th>
            <th>user</th>
        <% Vmstat.cpu.each do  |cpu|%>
            <tr>
                <% total = cpu.nice + cpu.idle + cpu.system + cpu.user 
                idle = cpu.idle.to_f / total.to_f * 100.0
                nice = cpu.nice.to_f  / total.to_f * 100.0
                system = cpu.system.to_f  / total.to_f * 100.0
                user = cpu.user.to_f  / total.to_f * 100.0 %>
                <td><%=cpu.num%> </td>
                <td><%=idle.to_i%> %</td>
                <td><%=nice.to_i%>%</td>
                <td><%=system.to_i%>%</td>
                <td><%=user.to_i%>%</td>                                
                </tr>

        <% end%>

        </table>

        <% 
        one = @snapshop.load_average.one_minute
        five =  @snapshop.load_average.five_minutes
        fithteen =  @snapshop.load_average.fifteen_minutes
         %><p>
         <strong>Load Averages</strong><br/>
         1 Minute:<b><%= one %></b><br>
         5 Minute:<b><%= five %></b><br /> 
         15 Minute:<b><%= fithteen%></b><br> 
         </p>
         <p>
             <strong>Memory</strong><br>
             <% ps = @snapshop.memory.pagesize
                 ps = ps/1024
                 active =  @snapshop.memory.active * ps
                 free =   @snapshop.memory.free * ps
                 inactive =  @snapshop.memory.inactive * ps
                 wired =  @snapshop.memory.wired * ps
             %>
             <table>
                 <th>Swap size</th>
                 <th>Free</th>
                 <th>active</th>
                 <th>inactive</th>
                 <th>wired</th>
                 <th>Pageins</th>
                 <th>PageOuts</th>
                 <tr>
                     <td>belum</td>
                     <td><%=free%></td>
                     <td><%=active%></td>
                     <td><%=inactive%></td>
                     <td><%=wired%></td>
                     <% rateout =@vm2.pageouts - @snapshop.memory.pageouts %>
                     <% ratein = @vm2.pageins - @snapshop.memory.pageins %>
                     <td><%=rateout%> </td>
                     <td><%=ratein %> </td>
                 </tr>
             </table>
         </p>

      </div>
    </div>
  </div>
</div>







 